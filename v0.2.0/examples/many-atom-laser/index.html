<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Many-atom laser · QuantumCumulants.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">QuantumCumulants.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../correlation/">Correlation functions and spectra</a></li><li><a class="tocitem" href="../../implementation/">Implementation</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single-atom-laser-spectrum/">Spectrum of a single-atom laser</a></li><li><a class="tocitem" href="../mollow/">Mollow Triplet</a></li><li class="is-active"><a class="tocitem" href>Many-atom laser</a></li><li><a class="tocitem" href="../optomechanical-cooling/">Optomechanical Cooling</a></li><li><a class="tocitem" href="../superradiant-laser/">Superradiant Laser</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Many-atom laser</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Many-atom laser</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/QuantumCumulants.jl/blob/master/docs/src/examples/many-atom-laser.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Many-atom-laser"><a class="docs-heading-anchor" href="#Many-atom-laser">Many-atom laser</a><a id="Many-atom-laser-1"></a><a class="docs-heading-anchor-permalink" href="#Many-atom-laser" title="Permalink"></a></h1><p>This example describes a second order laser system consisting of <span>$N$</span> three-level atoms coupled to a single mode cavity. An auxiliary state <span>$|3\rangle$</span>, which quickly decays into the upper lasing state <span>$|2\rangle$</span>, is coherently pumped to achieve population inversion on the lasing transition <span>$|1\rangle \leftrightarrow |2\rangle$</span>. The Hamiltonian of this system is given by</p><p class="math-container">\[H = -\Delta_{c} a^{\dagger} a  - \sum_{i=1}^N \left[ \Delta_3^i \sigma_i^{33}  + g_i (a^{\dagger} \sigma_i^{12} + a\sigma_i^{21}) + \Omega_i (\sigma_i^{31} + \sigma_i^{13}) \right].\]</p><p>Including dissipative processes as, e.g. the atomic decay or photon losses through the cavity mirrors, makes it an open quantum system. In the Schrödinger picture we would compute the dynamics of such open quantum systems with a density matrix <span>$\rho$</span> according to a master equation (see e.g. <a href="https://docs.qojulia.org/">https://docs.qojulia.org/</a>),</p><p class="math-container">\[\frac{d}{dt} \rho = - \frac{i}{\hbar} \left[ H, \rho \right] + \mathcal{L}[\rho],\]</p><p>with <span>$\mathcal{L}[\rho] = \frac{\gamma}{2} (2 J \rho J^\dagger - J^\dagger J \rho - \rho J^\dagger J)$</span> the Liouvillian superoperator in standard Lindblad form for a dissipative process with jump operator <span>$J$</span> and rate <span>$R$</span>.</p><p>With <strong>QuantumCumulants.jl</strong> we describe the system dynamics with averages, which are deduced from the operator equations of motion in the Heisenberg picture. In the Heisenberg picture open systems are described by the quantum Langevin equation. Assuming white noise, we can omit the stochastic terms of the quantum Langevin equation when computing averages. Thus we get the following equation for the time evolution of a system operator average <span>$\langle O \rangle$</span> (if <span>$O$</span> is not explicitly time dependent):</p><p class="math-container">\[\frac{d}{dt} \langle O \rangle = \frac{i}{\hbar} \left[ H, O \right] + \bar{\mathcal{L}}[O].\]</p><p>The superoperator <span>$\bar{\mathcal{L}}[O]$</span> is similar to the Lindblad term in the Schrödinger picture, except that <span>$J$</span> and <span>$J^\dagger$</span> are swapped in the first term, i.e. <span>$\bar{\mathcal{L}}[O] = \frac{\gamma}{2} (2 J^\dagger O J - J^\dagger J O - O J^\dagger J)$</span>, for a dissipative process with jump operator <span>$J$</span> and rate <span>$R$</span>.</p><p>For our system we have four different dissipative processes with the jump operators <span>$a$</span>, <span>$\sigma^{12}_i$</span>, <span>$\sigma^{13}_i$</span> and <span>$\sigma^{23}_i$</span>, and the corresponding decay rates <span>$\kappa$</span>, <span>$\Gamma^i_{12}$</span>, <span>$\Gamma^i_{13}$</span> and <span>$\Gamma^i_{23}$</span>, respectively.</p><p>We start by loading the needed packages.</p><pre><code class="language-julia">using QuantumCumulants
using ModelingToolkit, OrdinaryDiffEq
using Plots</code></pre><p>Then we define the symbolic parameters of the system, the Hilbertspace and the necessary operators. We define an atomic transition operator function <span>$\sigma(i,j,k)$</span> for the transition from <span>$|j \rangle$</span> to <span>$|i \rangle$</span> of atom <span>$k$</span>. Since we only have one <a href="../../api/#QuantumCumulants.FockSpace"><code>FockSpace</code></a> we do not need to specify the Hilbertspace on which the <a href="../../api/#QuantumCumulants.Destroy"><code>Destroy</code></a> operator acts. For the different atomic transitions, however, we need to specify this, since there is more than one <a href="../../api/#QuantumCumulants.NLevelSpace"><code>NLevelSpace</code></a>. This information is stored in the <code>.aon</code> field of each operator.</p><pre><code class="language-julia"># Parameters
N = 2 #number of atoms
κ, g, Γ23, Γ13, Γ12, Ω, Δc, Δ3 = cnumbers(&quot;κ g Γ_{23} Γ_{13} Γ_{12} Ω Δ_c Δ_3&quot;)

# Hilbertspace
hf = FockSpace(:cavity)
ha = ⊗([NLevelSpace(Symbol(:atom,i),3) for i=1:N]...)
h = hf ⊗ ha

# Operators
a = Destroy(h,:a)
σ(i,j,k) = Transition(h,Symbol(&quot;σ_{$k}&quot;),i,j,k+1)</code></pre><p>Now we create the Hamiltonian and the jumps with the corresponding rates of our laser system. We assume here that all atoms are identical.</p><pre><code class="language-julia"># Hamiltonian
H = -Δc*a&#39;a + sum(g*(a&#39;*σ(1,2,i) + a*σ(2,1,i)) for i=1:N) + sum(Ω*(σ(3,1,i) + σ(1,3,i)) for i=1:N) - sum(Δ3*σ(3,3,i) for i=1:N)

# Jumps
J = [a;[σ(1,2,i) for i=1:N];[σ(1,3,i) for i=1:N];[σ(2,3,i) for i=1:N]]

# Rates
rates = [κ;[Γ12 for i=1:N];[Γ13 for i=1:N];[Γ23 for i=1:N]]</code></pre><p>Later we will complete the system automatically, which has the disadvantage that the equations are not ordered. Therefore we define a list of interesting operators, which we want to use later. Note that at least one operator(-product) is needed. We derive the equations for these operators, average them, and automatically complete the system of equations.</p><pre><code class="language-julia"># list of operators
ops = [a&#39;a, σ(2,2,1), σ(3,3,1)]

eqs = meanfield(ops,H,J; rates=rates)
eqs_expanded = cumulant_expansion(eqs,2) #second order average</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 i g \left( \langle a^\dagger  \sigma_{1}^{12}\rangle  + \langle a^\dagger  \sigma_{2}^{12}\rangle  \right) + 1.0 i g \left( \langle a  \sigma_{1}^{21}\rangle  + \langle a  \sigma_{2}^{21}\rangle  \right) -1.0 \kappa \langle a^\dagger  a\rangle  \\
\frac{d}{dt} \langle \sigma_{1}^{22}\rangle  =&amp; \langle \sigma_{1}^{33}\rangle  \Gamma_{{23}} -1.0 \langle \sigma_{1}^{22}\rangle  \Gamma_{{12}} + 1.0 i g \langle a^\dagger  \sigma_{1}^{12}\rangle  -1.0 i g \langle a  \sigma_{1}^{21}\rangle  \\
\frac{d}{dt} \langle \sigma_{1}^{33}\rangle  =&amp; -1.0 i \langle \sigma_{1}^{31}\rangle  \Omega + 1.0 i \langle \sigma_{1}^{13}\rangle  \Omega -1.0 \langle \sigma_{1}^{33}\rangle  \left( \Gamma_{{13}} + \Gamma_{{23}} \right)
\end{align}\]</p><pre><code class="language-julia">me_comp = complete(eqs_expanded) #automatically complete the system</code></pre><p>To calculate the time evolution we create a Julia function which can be used by DifferentialEquations.jl to solve the set of ordinary differential equations.</p><pre><code class="language-julia"># Build an ODESystem out of the MeanfieldEquations
@named sys = ODESystem(me_comp)</code></pre><p>Finally we compute the time evolution after defining an initial state and numerical values for the parameters.</p><pre><code class="language-julia"># initial state
u0 = zeros(ComplexF64, length(me_comp))

Γ12n = 1.0
Γ23n = 20Γ12n
Γ13n = 2Γ12n
Ωn = 5Γ13n
gn = 2Γ12n
Δcn = 0.0
Δ3n = 0.0
κn = 0.5Γ12n

# list of parameters
ps = (g, Γ23, Γ13, Γ12, Ω, Δc, Δ3, κ)
p0 = ps .=&gt; (gn, Γ23n, Γ13n, Γ12n, Ωn, Δcn, Δ3n, κn)
tend = 10.0/κn

prob = ODEProblem(sys,u0,(0.0,tend),p0)
sol = solve(prob, Tsit5(), reltol=1e-8, abstol=1e-8)</code></pre><p>We plot the average photon number and the population inversion of the lasing transition.</p><pre><code class="language-julia">n_t = real.(sol[average(a&#39;*a)])
σ22m11_t = real.(2*sol[σ(2,2,1)] .+ sol[σ(3,3,1)] .-1 ) #σ11 + σ22 + σ33 = 𝟙

# Plot
p1 = plot(sol.t, n_t, xlabel=&quot;tΓ₁₂&quot;, ylabel=&quot;⟨a⁺a⟩&quot;, legend = false)
p2 = plot(sol.t, σ22m11_t, xlabel=&quot;tΓ₁₂&quot;, ylabel=&quot;⟨σ22⟩ - ⟨σ11⟩&quot;, legend = false)
plot(p1, p2, layout=(1,2), size=(800,300))</code></pre><p><img src="../3-level-laser.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mollow/">« Mollow Triplet</a><a class="docs-footer-nextpage" href="../optomechanical-cooling/">Optomechanical Cooling »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/qojulia/QuantumCumulants.jl"><strong>Back to GitHub</strong></a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 23 November 2021 11:23">Tuesday 23 November 2021</span>. Using Julia version 1.6.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
