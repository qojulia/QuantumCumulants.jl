<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Superradiant Laser · QuantumCumulants.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">QuantumCumulants.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../correlation/">Correlation functions and spectra</a></li><li><a class="tocitem" href="../../implementation/">Implementation</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single-atom-laser-spectrum/">Spectrum of a single-atom laser</a></li><li><a class="tocitem" href="../mollow/">Mollow Triplet</a></li><li><a class="tocitem" href="../many-atom-laser/">Many-atom laser</a></li><li><a class="tocitem" href="../optomechanical-cooling/">Optomechanical Cooling</a></li><li class="is-active"><a class="tocitem" href>Superradiant Laser</a><ul class="internal"><li><a class="tocitem" href="#Spectrum"><span>Spectrum</span></a></li></ul></li><li><a class="tocitem" href="../excitation-transport-chain/">Noisy excitation transport</a></li><li><a class="tocitem" href="../cavity_antiresonance/">Cavity Antiresonance</a></li><li><a class="tocitem" href="../ramsey_spectroscopy/">Ramsey Spectroscopy</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Superradiant Laser</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Superradiant Laser</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/qojulia/QuantumCumulants.jl/blob/master/docs/src/examples/superradiant-laser.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Superradiant-Laser"><a class="docs-heading-anchor" href="#Superradiant-Laser">Superradiant Laser</a><a id="Superradiant-Laser-1"></a><a class="docs-heading-anchor-permalink" href="#Superradiant-Laser" title="Permalink"></a></h1><p>Using symmetry properties of a system can reduce the number of needed equations dramatically. A common approximation for laser systems to handle sufficiently big atom numbers is to assume that several atoms in the system behave completely identically. This means all the identical atoms have the same averages.</p><p>In this example we describe a so-called superradiant laser, where we assume all atoms to be identical. This model has been described in <a href="https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.102.163601">D. Meiser et al., Phys. Rev. Lett. 102, 163601 (2009):</a> The Hamiltonian of this system is</p><p class="math-container">\[H = - \hbar \Delta a^\dagger a +  \hbar \sum\limits_{j=1}^{N}  g_j (a^\dagger \sigma^{12}_{j} + a \sigma^{21}_{j}),\]</p><p>where <span>$\Delta = \omega_a - \omega_c$</span> is the detuning between the cavity (<span>$\omega_c$</span>) and the atomic (<span>$\omega_a$</span>) resonance frequency, the atom cavity coupling of the atom <span>$j$</span> is denoted by <span>$g_j$</span>. Additionally there are dissipative processes in the system, namely: Atoms are incoherently pumped with the rate <span>$R$</span>, they decay individually with the rate <span>$\Gamma$</span> and are affected by individual atomic dephasing with the rate <span>$\nu$</span>. Photons leak out of the system with the rate <span>$\kappa$</span>.</p><p>We start by loading the packages.</p><pre><code class="language-julia">using QuantumCumulants
using OrdinaryDiffEq, SteadyStateDiffEq, ModelingToolkit
using Plots</code></pre><p>To give QuantumCumulants the information that several atoms behave identically we need to create a <span>$\texttt{ClusterSpace}$</span> on the desired Hilbert space. This <span>$\texttt{ClusterSpace}$</span> additionally needs the order <span>$M$</span> of the system and a symbolic parameter for the number of identical elements <span>$N$</span>.</p><pre><code class="language-julia">M = 2 # order
@cnumbers N Δ g κ Γ R ν

# Hilbertspace
hc = FockSpace(:cavity)
ha_ = NLevelSpace(:atom,2)
ha = ClusterSpace(ha_, N, M)
h = hc ⊗ ha</code></pre><pre class="documenter-example-output">ℋ(cavity) ⊗ Nxℋ(atom)</pre><p>Now we can define the operators on the composite Hilbert space including the <span>$\texttt{ClusterSpace}$</span>, the workflow is completely the same as for &#39;normal&#39; Hilbert spaces.</p><pre><code class="language-julia"># operators
@qnumbers a::Destroy(h)
σ(i,j) = Transition(h, :σ, i, j, 2)
σ(2,2)</code></pre><pre class="documenter-example-output">2-element Vector{QSym}:
 σ_122
 σ_222</pre><p>What is different, however, is that the transition operator defined on the <span>$\texttt{ClusterSpace}$</span> is an array of <span>$M$</span> transitions defined on internally created sub-Hilbert spaces. The reason for this is the following: Although we assume all atoms to be identical, we still need to keep track of the correlations between different atoms. Since <span>$\langle \sigma^{21}_1 \sigma^{12}_1 \rangle = \langle \sigma^{22}_1 \rangle$</span> is obviously not equal to <span>$\langle \sigma^{21}_1 \sigma^{12}_2 \rangle$</span> at least a second atom is needed for a second order description. On the other hand, as all atoms are the same, it must hold that <span>$\langle \sigma^{21}_1 \sigma^{12}_2 \rangle = \langle \sigma^{21}_\alpha \sigma^{12}_\beta \rangle$</span> for all <span>$\alpha \ne \beta$</span>, therefore two atoms are sufficient. For higher orders and or bosonic operators the arguments are the same.</p><p>The symbolic calculation rules for these operators acting on a <span>$\texttt{ClusterSpace}$</span> are implemented such that e.g. <span>$\sum\limits_j \sigma^{22}_j$</span> can be written as <span>$sum(\sigma(2,2))$</span> in the code. For the jump operators the syntax is such that individual atomic dissipation is written as <span>$J = [σ(i,j)]$</span>, whereas collective behaviour is expressed as <span>$J = sum(σ(i,j))$</span>. The Hamiltonian and the dissipative processes for individual atomic behaviour are therefore</p><pre><code class="language-julia"># Hamiltonian
H = -Δ*a&#39;a + g*(a&#39;*sum(σ(1,2)) + a*sum(σ(2,1)))

# Jump operators &amp; rates
J = [a, σ(1,2), σ(2,1), σ(2,2)]
rates = [κ, Γ, R, ν]</code></pre><p>First we want to derive the equation for <span>$\langle a^\dagger a \rangle$</span> and <span>$\langle \sigma_1^{22} \rangle$</span>. <span>$\texttt{QuantumCumulants}$</span> automatically sets the right scaling factors in the equations to account for the number of identical atoms and also replaces redundant averages, e.g. <span>$\langle \sigma_2^{22} \rangle$</span> is replaced by <span>$\langle \sigma_1^{22} \rangle$</span> in the equations, since all atoms behave identically these two averages are the same.</p><pre><code class="language-julia"># Derive equations
ops = [a&#39;*a, σ(2,2)[1]]
eqs = meanfield(ops,H,J;rates=rates,order=M)</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 \kappa \langle a^\dagger  a\rangle  -1.0 i N g \langle a^\dagger  {\sigma_1}^{{12}}\rangle  + 1.0 i N g \langle a  {\sigma_1}^{{21}}\rangle  \\
\frac{d}{dt} \langle {\sigma_1}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma_1}^{{22}}\rangle  + 1 i g \langle a^\dagger  {\sigma_1}^{{12}}\rangle  -1 i g \langle a  {\sigma_1}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma_1}^{{22}}\rangle
\end{align}\]</p><p>To get a closed set of equations we automatically complete the system. Since this system is phase invariant we know that all averages with a phase are zero, therefore we exclude these terms with a filter function.</p><pre><code class="language-julia"># custom filter function
φ(x::Average) = φ(x.arguments[1])
φ(::Destroy) = -1
φ(::Create) =1
φ(x::QTerm) = sum(map(φ, x.args_nc))
φ(x::Transition) = x.i - x.j
phase_invariant(x) = iszero(φ(x))

# Complete equations
eqs_c = complete(eqs; filter_func=phase_invariant)</code></pre><p class="math-container">\[\begin{align}
\frac{d}{dt} \langle a^\dagger  a\rangle  =&amp; -1.0 \kappa \langle a^\dagger  a\rangle  -1.0 i N g \langle a^\dagger  {\sigma_1}^{{12}}\rangle  + 1.0 i N g \langle a  {\sigma_1}^{{21}}\rangle  \\
\frac{d}{dt} \langle {\sigma_1}^{{22}}\rangle  =&amp; R -1.0 R \langle {\sigma_1}^{{22}}\rangle  + 1 i g \langle a^\dagger  {\sigma_1}^{{12}}\rangle  -1 i g \langle a  {\sigma_1}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma_1}^{{22}}\rangle  \\
\frac{d}{dt} \langle a^\dagger  {\sigma_1}^{{12}}\rangle  =&amp; -0.5 R \langle a^\dagger  {\sigma_1}^{{12}}\rangle  + 1 i g \langle {\sigma_1}^{{22}}\rangle  -1 i g \langle a^\dagger  a\rangle  -0.5 \Gamma \langle a^\dagger  {\sigma_1}^{{12}}\rangle  -1 i \Delta \langle a^\dagger  {\sigma_1}^{{12}}\rangle  -0.5 \kappa \langle a^\dagger  {\sigma_1}^{{12}}\rangle  -0.5 \nu \langle a^\dagger  {\sigma_1}^{{12}}\rangle  + 2 i g \langle {\sigma_1}^{{22}}\rangle  \langle a^\dagger  a\rangle  + 1 i g \langle {\sigma_1}^{{21}}  {\sigma_2}^{{12}}\rangle  \left( -1 + N \right) \\
\frac{d}{dt} \langle {\sigma_1}^{{21}}  {\sigma_2}^{{12}}\rangle  =&amp; -1.0 R \langle {\sigma_1}^{{21}}  {\sigma_2}^{{12}}\rangle  + 1 i g \langle a^\dagger  {\sigma_1}^{{12}}\rangle  -1 i g \langle a  {\sigma_1}^{{21}}\rangle  -1.0 \Gamma \langle {\sigma_1}^{{21}}  {\sigma_2}^{{12}}\rangle  -1.0 \nu \langle {\sigma_1}^{{21}}  {\sigma_2}^{{12}}\rangle  -2 i g \langle {\sigma_1}^{{22}}\rangle  \langle a^\dagger  {\sigma_1}^{{12}}\rangle  + 2 i g \langle {\sigma_1}^{{22}}\rangle  \langle a  {\sigma_1}^{{21}}\rangle
\end{align}\]</p><p>To calculate the dynamics of the system we create a system of ordinary differential equations, which can be used by <a href="https://diffeq.sciml.ai/stable/">DifferentialEquations.jl</a>.</p><pre><code class="language-julia">@named sys = ODESystem(eqs_c)</code></pre><p>Finally we need to define the numerical parameters and the initial state of the system. We will consider <span>$2 \cdot 10^5$</span> Strontium atoms which are repumped with a rate of <span>$R = 1\text{Hz}$</span> on the clock transition (<span>$\Gamma = 1 \text{mHz}$</span>). The atom-cavity coupling rate is <span>$g = 1\text{Hz}$</span>, the cavity has a linewidth of <span>$\kappa = 5\text{kHz}$</span> and is detuned from the atomic resonance by <span>$\Delta = 2.5\text{Hz}$</span>.</p><pre><code class="language-julia"># Initial state
u0 = zeros(ComplexF64, length(eqs_c))
# System parameters
N_ = 2e5
Γ_ = 1.0 #Γ=1mHz
Δ_ = 2500Γ_ #Δ=2.5Hz
g_ = 1000Γ_ #g=1Hz
κ_ = 5e6*Γ_ #κ=5kHz
R_ = 1000Γ_ #R=1Hz
ν_ = 1000Γ_ #ν=1Hz

ps = [N, Δ, g, κ, Γ, R, ν]
p0 = [N_, Δ_, g_, κ_, Γ_, R_, ν_]

prob = ODEProblem(sys,u0,(0.0, 1.0/50Γ_), ps.=&gt;p0)</code></pre><pre><code class="language-julia">sol = solve(prob,Tsit5(),maxiters=1e7)</code></pre><pre><code class="language-julia"># Plot time evolution
t = sol.t
n = real.(sol[a&#39;a])
s22 = real.(sol[σ(2,2)[1]])

# Plot
p1 = plot(t, n, xlabel=&quot;tΓ&quot;, ylabel=&quot;⟨a⁺a⟩&quot;, legend=false)
p2 = plot(t, s22, xlabel=&quot;tΓ&quot;, ylabel=&quot;⟨σ22⟩&quot;, legend=false)
plot(p1, p2, layout=(1,2), size=(700,300))</code></pre><p><img src="../superradiant_laser_time.svg" alt="svg"/></p><h2 id="Spectrum"><a class="docs-heading-anchor" href="#Spectrum">Spectrum</a><a id="Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#Spectrum" title="Permalink"></a></h2><p>We calculate the spectrum here with the Laplace transform of the two-time correlation function. This is implemented with the function <span>$\texttt{Spectrum}$</span>.</p><pre><code class="language-julia">corr = CorrelationFunction(a&#39;, a, eqs_c; steady_state=true, filter_func=phase_invariant)
S = Spectrum(corr, ps)</code></pre><p>The set of equations for the correlation function is given by</p><pre><code class="language-julia">corr.de</code></pre><p class="math-container">\[\begin{align}
\frac{d}{d\tau} \langle a^\dagger  a_0\rangle  =&amp; -1 i \Delta \langle a^\dagger  a_0\rangle  -0.5 \kappa \langle a^\dagger  a_0\rangle  + 1.0 i N g \langle {\sigma_1}^{{21}}  a_0\rangle  \\
\frac{d}{d\tau} \langle {\sigma_1}^{{21}}  a_0\rangle  =&amp; -0.5 R \langle {\sigma_1}^{{21}}  a_0\rangle  + 1 i g \langle a^\dagger  a_0\rangle  -0.5 \Gamma \langle {\sigma_1}^{{21}}  a_0\rangle  -0.5 \nu \langle {\sigma_1}^{{21}}  a_0\rangle  -2 i g \langle {\sigma_1}^{{22}}\rangle  \langle a^\dagger  a_0\rangle
\end{align}\]</p><p>To ensure we are in the steady state we use a steady solver to calculate it. To this end we need to define the <span>$\texttt{SteadyStateProblem}$</span> and specify the desired method. We also need to increase the <span>$\texttt{maxiters}$</span> and the solver accuracy to handle this numerically involved problem.</p><pre><code class="language-julia">prob_ss = SteadyStateProblem(prob)
sol_ss = solve(prob_ss, DynamicSS(Tsit5(); abstol=1e-8, reltol=1e-8),
    reltol=1e-14, abstol=1e-14, maxiters=5e7)</code></pre><p>The spectrum is then calculated with</p><pre><code class="language-julia">ω = [-10:0.01:10;]Γ_
spec = S(ω,sol_ss.u,p0)
spec_n = spec ./ maximum(spec)
δ = abs(ω[(findmax(spec)[2])])</code></pre><pre class="documenter-example-output">1.0</pre><pre><code class="language-julia">plot(ω, spec_n, xlabel=&quot;ω/Γ&quot;, legend=false, size=(500,300))</code></pre><p><img src="../superradiant_laser_spec.svg" alt="svg"/></p><p>Beside the narrow linewidth we can also see another key feature of the superradiant laser here, namely the very weak cavity pulling. At a detunig of <span>$\Delta = 2500\Gamma$</span> there is only a shift of the laser light from the atomic resonance frequency of <span>$\delta = 1\Gamma$</span>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The implementation of the scaling rules are still in an early stage of development and they are quite &#39;experimental&#39;. So make sure to double check the equations when using them in more complicated systems.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../optomechanical-cooling/">« Optomechanical Cooling</a><a class="docs-footer-nextpage" href="../excitation-transport-chain/">Noisy excitation transport »</a><div class="flexbox-break"></div><p class="footer-message"><a href="https://github.com/qojulia/QuantumCumulants.jl"><strong>Back to GitHub</strong></a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 16 September 2022 08:38">Friday 16 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
