<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Heterodyne detection of emission from atomic ensemble · QuantumCumulants.jl</title><meta name="title" content="Heterodyne detection of emission from atomic ensemble · QuantumCumulants.jl"/><meta property="og:title" content="Heterodyne detection of emission from atomic ensemble · QuantumCumulants.jl"/><meta property="twitter:title" content="Heterodyne detection of emission from atomic ensemble · QuantumCumulants.jl"/><meta name="description" content="Documentation for QuantumCumulants.jl."/><meta property="og:description" content="Documentation for QuantumCumulants.jl."/><meta property="twitter:description" content="Documentation for QuantumCumulants.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">QuantumCumulants.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../theory/">Theoretical background</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../correlation/">Correlation functions and spectra</a></li><li><a class="tocitem" href="../../symbolic_sums/">Symbolic Sums and Indices</a></li><li><a class="tocitem" href="../../implementation/">Implementation</a></li><li><a class="tocitem" href="../../api/">API</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../single-atom-laser-spectrum/">Spectrum of a single-atom laser</a></li><li><a class="tocitem" href="../mollow/">Mollow Triplet</a></li><li><a class="tocitem" href="../many-atom-laser/">Many-atom laser</a></li><li><a class="tocitem" href="../optomechanical-cooling/">Optomechanical Cooling</a></li><li><a class="tocitem" href="../excitation-transport-chain/">Noisy excitation transport</a></li><li><a class="tocitem" href="../ramsey_spectroscopy/">Ramsey Spectroscopy</a></li><li><a class="tocitem" href="../superradiant_laser_indexed/">Superradiant Laser</a></li><li><a class="tocitem" href="../cavity_antiresonance_indexed/">Cavity Antiresonance</a></li><li><a class="tocitem" href="../filter-cavity_indexed/">Laser with Filter Cavities</a></li><li><a class="tocitem" href="../unique_squeezing/">Unique Steady-State Squeezing</a></li><li><a class="tocitem" href="../superradiant-laser/">Superradiant Laser (outdated)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Heterodyne detection of emission from atomic ensemble</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Heterodyne detection of emission from atomic ensemble</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qojulia/QuantumCumulants.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qojulia/QuantumCumulants.jl/blob/master/docs/src/examples/heterodyne_detection.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Heterodyne-detection-of-emission-from-atomic-ensemble"><a class="docs-heading-anchor" href="#Heterodyne-detection-of-emission-from-atomic-ensemble">Heterodyne detection of emission from atomic ensemble</a><a id="Heterodyne-detection-of-emission-from-atomic-ensemble-1"></a><a class="docs-heading-anchor-permalink" href="#Heterodyne-detection-of-emission-from-atomic-ensemble" title="Permalink"></a></h1><p>This example implements the heterodyne detection of the light emitted by an ensemble of atoms (see https://arxiv.org/abs/2211.13068). We thus describe the stochastic master equation time evolution that governs the measurement backaction on the system. </p><pre><code class="language-julia hljs">using QuantumCumulants
using SymbolicUtils
using Symbolics
using ModelingToolkit
using StochasticDiffEq
using DifferentialEquations
using PyPlot
using Statistics</code></pre><h1 id="System-definition"><a class="docs-heading-anchor" href="#System-definition">System definition</a><a id="System-definition-1"></a><a class="docs-heading-anchor-permalink" href="#System-definition" title="Permalink"></a></h1><p>The system we discuss is an ensemble of <span>$N$</span> equivalent atoms (two level systems with transition operators <span>$\sigma_{1,2,j}$</span> and frequency <span>$\omega_a$</span>) coupled to a cavity mode <span>$\hat a$</span>, all with the same coupling <span>$g$</span> and free space decay rate <span>$\kappa$</span>. The cavity has frequency <span>$\omega_c$</span> and decay rate <span>$\kappa$</span>. We are in the frame rotating with the frequency <span>$\omega_a=\omega_c$</span>.</p><p>The system Hamiltonian is then</p><p>\begin{equation} H=\omega<em>c\hat a^\dagger\hat a+\omega</em>a\sum<em>j\sigma</em>{2,2,j}+\hat a^\dagger\sigma<em>{1,2,j}+g\hat a\sigma</em>{2,1,j}. \end{equation}</p><pre><code class="language-julia hljs">@cnumbers N ωa γ η χ ωc κ g ξ ωl
@syms t::Real
@register pulse(t)

hc = FockSpace(:resonator)
ha = NLevelSpace(:atom,2)
h = hc ⊗ ha

j = Index(h,:j,N,ha)
k = Index(h,:k,N,ha)

@qnumbers a::Destroy(h,1)
σ(α,β,k) = IndexedOperator(Transition(h,:σ,α,β,2), k)
H = ωc * a&#39; * a + ωa * Σ(σ(2,2,j),j)+g*a&#39;*Σ(σ(1,2,j),j)+g*a*Σ(σ(2,1,j),j);</code></pre><h1 id="Decay-terms"><a class="docs-heading-anchor" href="#Decay-terms">Decay terms</a><a id="Decay-terms-1"></a><a class="docs-heading-anchor-permalink" href="#Decay-terms" title="Permalink"></a></h1><p>We then include four terms in the Lindblad term of the Master equation. We include spontaneous decay of the cavity mode, where we choose the decay operator to be <span>$\hat a\exp(\rm{i}\omega_lt)$</span> for convenience (we will see later why this is reasonable and you can convince yourself that it gives the same decay term as <span>$\hat a$</span>). The free dacay of the atoms with <span>$\gamma$</span> is given by the decay operator <span>$\sigma_{1,2,j}$</span>.</p><p>We also include an incoherent pump <span>$\sigma_{2,1,j}$</span> with amplitude <span>$\eta$</span>, which is a pulse that is on between <span>$t_0$</span> and <span>$t_0+t_1$</span>. The last term is a dephasing term with strength <span>$\chi$</span> corresponding to the operator <span>$\sigma_{2,2,j}$</span>.</p><pre><code class="language-julia hljs">J = [a*exp(1.0im*ωl*t),σ(1,2,j),σ(2,1,j),σ(2,2,j)]
rates = [κ,γ,η*pulse(t),2*χ]

function pulse(t)
    if t&gt;t0 &amp;&amp; t&lt;t0+t1
        return 1
    else
        return 0
    end
end</code></pre><h1 id="Stochastic-measurement-terms"><a class="docs-heading-anchor" href="#Stochastic-measurement-terms">Stochastic measurement terms</a><a id="Stochastic-measurement-terms-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-measurement-terms" title="Permalink"></a></h1><p>We include the measurement terms by defining measurement efficiencies for all decay channels. A channel with efficiency zero is ignored, i.e. not measured. The operator <span>$\hat a\exp(\rm{i}\omega_lt)$</span> corresponding to heterodyne detection with local oscillator frequency <span>$\omega_l$</span> is then measured with efficiency <span>$\xi$</span>. </p><p>Such measurement terms are then included in the equation of motion for system operators is then included as </p><p>\begin{equation} d\langle\hat A\rangle=\sqrt{\xi\kappa/2}\langle \hat a^\dagger \rm{e}^{-\rm{i}\omega<em>lt}\hat A+\hat A\hat a\rm{e}^{\rm{i}\omega</em>lt} -\hat a\langle\hat a \rm{e}^{\rm{i}\omega<em>lt}+\hat a^\dagger \rm{e}^{-\rm{i}\omega</em>lt}\rangle\rangle \end{equation}</p><p>for the operator <span>$\hat a \rm{e}^{\rm{i}\omega_lt}$</span>  corresponding to heterodyne detection.</p><pre><code class="language-julia hljs">efficiencies = [ξ,0,0,0]
ops = [a&#39;,a&#39;*a,σ(2,2,k),σ(1,2,k), a*a];
eqs = meanfield(ops,H,J; rates = rates, efficiencies = efficiencies, order = 2)</code></pre><h1 id="Finding-the-equations-of-motion"><a class="docs-heading-anchor" href="#Finding-the-equations-of-motion">Finding the equations of motion</a><a id="Finding-the-equations-of-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Finding-the-equations-of-motion" title="Permalink"></a></h1><p>The completion and scaling as previously discussed in other examples work exactly the same way for equations including noise terms.</p><pre><code class="language-julia hljs">eqs_c = indexed_complete(eqs)
scaled_eqs = scale(eqs_c)</code></pre><h1 id="Deterministic-time-evolution"><a class="docs-heading-anchor" href="#Deterministic-time-evolution">Deterministic time evolution</a><a id="Deterministic-time-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Deterministic-time-evolution" title="Permalink"></a></h1><p>Here we define the actual values for the system parameters. We then show that the deterministic time evolution without the noise terms is still accesible by using the constructor ODESystem for the stochastic system of equations and the syntax for the simulation of the time evolution is as usual.</p><pre><code class="language-julia hljs">ωc_ = 0.0; κ_ = 2.0 * π * 2.26e6; ξ_ = 0.12; N_=5e4; 
ωa_ = 0.0; γ_ = 2.0 * π * 375; η_ = 2.0 * π * 20e3; χ_ = 0.1; 
g_ = 6.531*10^3; ωl_ = 2.0 * π * 10^3; t0=0.0;t1=20e-6
p = [N,ωa,γ,η,χ,ωc,κ,g,ξ,ωl]
p0 = [N_,ωa_,γ_,η_,χ_,ωc_,κ_,g_,ξ_,ωl_]

@named sys = ODESystem(scaled_eqs)
u0 = zeros(ComplexF64,length(scaled_eqs.equations))
prob = ODEProblem(sys, u0,(0.0,1e-3),p.=&gt;p0)
sol_det = solve(prob,RK4(),dt=1e-9)

plot(sol_det.t .* 1000, map(x -&gt; real(x[2]), sol_det.u))
xlim(left = 0.0, right = 0.1)
ylabel(&quot;Cavity phonon number&quot;)
xlabel(&quot;Time (ms)&quot;)</code></pre><h1 id="Stochastic-time-evolution"><a class="docs-heading-anchor" href="#Stochastic-time-evolution">Stochastic time evolution</a><a id="Stochastic-time-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-time-evolution" title="Permalink"></a></h1><p>The stochastic time evolution is accesible via the constructor SDESystem, whose syntax is exactly the same as for the ODESystem, but with keyword args as defined in https://docs.sciml.ai/DiffEqDocs/stable/tutorials/sde_example/. We then need to provide a noise process for the measurement. If the noise is white the appropriate noise process is a Wiener process. The SDEProblem is then constructed just as the ODEProblem, but with an additional noise argument.</p><p>We can then make use of the EnsembleProblem which automatically runs multiple instances of the stochastic equations of motion. The number of trajectories can then be set in the solve call. See the documentation cited above for more details of the function calls here.</p><pre><code class="language-julia hljs">@named sys = SDESystem(scaled_eqs)
u0 = zeros(ComplexF64,length(scaled_eqs.equations))
noise = StochasticDiffEq.RealWienerProcess(0.0, 0.0)
prob = SDEProblem(sys, u0,(0.0,0.1*1e-3),p.=&gt;p0,noise=noise)

eprob = EnsembleProblem(prob)
sol = solve(eprob,StochasticDiffEq.EM(), dt = 1e-9, save_noise=true,trajectories=256,saveat=0:1e-6:0.1*1e-3)</code></pre><h1 id="Plot-the-average-of-the-cavity-number"><a class="docs-heading-anchor" href="#Plot-the-average-of-the-cavity-number">Plot the average of the cavity number</a><a id="Plot-the-average-of-the-cavity-number-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-average-of-the-cavity-number" title="Permalink"></a></h1><p>Here we plot the average of the cavity number for the stochastic and determinstic equation of motion with the trajectories in grey in the background. We can see that the dynamics of the system is indeed modified by the measurement backaction.</p><pre><code class="language-julia hljs">us = fill(0.0, length(sol.u), length(sol.u[1].t))
for (i, el) in enumerate(sol.u)
    u = map(x-&gt;real(x[2]), el)
    if length(u) == size(us, 2) us[i,:] .+= u else continue end
    plot(el.t .* 1000, u, color = &quot;grey&quot;, alpha = 0.1)
end

plot(sol.u[1].t .* 1000, mean(us, dims = 1)[1,:], color = &quot;red&quot;, label = &quot;stochastic&quot;)
plot(sol_det.t .* 1000, map(x -&gt; real(x[2]), sol_det.u), color = &quot;blue&quot;, label = &quot;deterministic&quot;)
xlim(left = 0.0, right = 0.1)
ylim(bottom = 0, top = 500)
ylabel(&quot;Cavity phonon number&quot;)
xlabel(&quot;Time (ms)&quot;)
legend()</code></pre><h1 id="Plot-the-average-of-the-cavity-field-amplitude"><a class="docs-heading-anchor" href="#Plot-the-average-of-the-cavity-field-amplitude">Plot the average of the cavity field amplitude</a><a id="Plot-the-average-of-the-cavity-field-amplitude-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-average-of-the-cavity-field-amplitude" title="Permalink"></a></h1><p>For the cavity field amplitude we see that the ensemble average becomes zero, but the trajectories have finite cavity field amplitude </p><pre><code class="language-julia hljs">us = fill(0.0, length(sol.u), length(sol.u[1].t))
for (i, el) in enumerate(sol.u)
    u = map(x-&gt;real(x[1]), el)
    if length(u) == size(us, 2) us[i,:] .+= u else continue end
    plot(el.t .* 1000, u, color = &quot;grey&quot;, alpha = 0.05)
end

plot(sol_det.t .* 1000, map(x -&gt; real(x[1]), sol_det.u), color = &quot;blue&quot;, label = &quot;deterministic&quot;)
plot(sol.u[1].t .* 1000, mean(us, dims = 1)[1,:], color = &quot;red&quot;, label = &quot;stochastic&quot;)
xlim(left = 0.0, right = 0.1)
ylabel(&quot;Cavity field&quot;)
xlabel(&quot;Time (ms)&quot;)
legend()</code></pre></article><nav class="docs-footer"><p class="footer-message"><a href="https://github.com/qojulia/QuantumCumulants.jl"><strong>Back to GitHub</strong></a></p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 15 April 2024 21:09">Monday 15 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
